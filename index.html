<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏à‡∏≠‡∏á‡∏ï‡∏±‡πã‡∏ß‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ö‡∏¥‡∏ô</title>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); min-height: 100vh; padding: 20px 0; }
        .container { max-width: 600px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); }
        .header { background: linear-gradient(135deg, #2e7d32 0%, #1b5e20 100%); color: white; padding: 30px 20px; text-align: center; border-radius: 20px 20px 0 0; }
        .header h1 { font-size: 28px; margin-bottom: 5px; }
        .header p { font-size: 14px; opacity: 0.95; }
        .user-info { display: flex; align-items: center; gap: 10px; margin-top: 15px; padding: 10px; background: rgba(255,255,255,0.2); border-radius: 10px; }
        .user-info img { width: 40px; height: 40px; border-radius: 50%; border: 2px solid white; }
        .form-container { padding: 30px 20px; }
        .trip-type { display: flex; gap: 20px; margin-bottom: 30px; }
        .radio-group { display: flex; align-items: center; gap: 8px; cursor: pointer; }
        .radio-group input[type="radio"] { width: 20px; height: 20px; cursor: pointer; accent-color: #2e7d32; }
        .radio-group label { cursor: pointer; font-size: 16px; }
        .section { background: #f8f9fa; border-radius: 15px; padding: 20px; margin-bottom: 20px; }
        .section-title { font-size: 14px; color: #2e7d32; margin-bottom: 15px; font-weight: 600; }
        .location-inputs { display: flex; gap: 15px; align-items: center; }
        .input-group { flex: 1; }
        .input-group label { display: block; margin-bottom: 8px; color: #666; font-size: 14px; }
        .input-group input, .input-group select { width: 100%; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 16px; transition: all 0.3s; }
        .input-group input:focus, .input-group select:focus { outline: none; border-color: #2e7d32; }
        .input-group input:disabled { background: #f5f5f5; cursor: not-allowed; }
        .input-group small { display: block; margin-top: 5px; color: #999; font-size: 12px; }
        .input-group .error { color: #d32f2f; font-size: 12px; margin-top: 5px; display: none; }
        .input-group.has-error input { border-color: #d32f2f; }
        .input-group.has-error .error { display: block; }
        .swap-btn { background: white; border: 2px solid #2e7d32; border-radius: 50%; width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s; margin-top: 25px; flex-shrink: 0; }
        .swap-btn:hover { background: #2e7d32; transform: rotate(180deg); }
        .swap-btn svg { width: 24px; height: 24px; fill: #2e7d32; transition: fill 0.3s; }
        .swap-btn:hover svg { fill: white; }
        .date-inputs { display: flex; gap: 15px; }
        .passenger-row { display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-bottom: 1px solid #e0e0e0; }
        .passenger-row:last-child { border-bottom: none; }
        .passenger-info h3 { font-size: 16px; margin-bottom: 5px; }
        .passenger-info p { font-size: 12px; color: #999; }
        .counter { display: flex; align-items: center; gap: 15px; }
        .counter-btn { width: 35px; height: 35px; border-radius: 50%; border: 2px solid #2e7d32; background: white; color: #2e7d32; font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s; }
        .counter-btn:hover:not(:disabled) { background: #2e7d32; color: white; }
        .counter-btn:disabled { opacity: 0.3; cursor: not-allowed; }
        .counter-value { font-size: 18px; font-weight: bold; min-width: 30px; text-align: center; }
        .submit-btn { width: 100%; padding: 18px; background: linear-gradient(135deg, #2e7d32 0%, #1b5e20 100%); color: white; border: none; border-radius: 15px; font-size: 18px; font-weight: bold; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 15px rgba(46, 125, 50, 0.4); }
        .submit-btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(46, 125, 50, 0.6); }
        .submit-btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .footer-note { text-align: center; color: #999; font-size: 13px; margin-top: 15px; }
        .loading-overlay { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 9999; align-items: center; justify-content: center; }
        .loading-overlay.active { display: flex; }
        .loading-content { background: white; padding: 30px; border-radius: 15px; text-align: center; }
        .spinner { width: 50px; height: 50px; border: 5px solid #f3f3f3; border-top: 5px solid #2e7d32; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .success-message, .error-message { display: none; color: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; text-align: center; }
        .success-message { background: #4caf50; }
        .error-message { background: #f44336; }
        @media (max-width: 600px) { .location-inputs { flex-direction: column; } .swap-btn { margin-top: 0; transform: rotate(90deg); } .swap-btn:hover { transform: rotate(270deg); } .date-inputs { flex-direction: column; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ö‡∏¥‡∏ô</h1>
            <p>‡πÄ‡∏ä‡πá‡∏Ñ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏±‡πã‡∏ß‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ö‡∏¥‡∏ô ‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì üòä</p>
            <div class="user-info" id="userInfo" style="display: none;">
                <img id="userPicture" src="" alt="Profile">
                <div class="name" id="userName">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
            </div>
        </div>
        <div class="form-container">
            <div class="success-message" id="successMessage"></div>
            <div class="error-message" id="errorMessage"></div>
            <div class="trip-type">
                <div class="radio-group"><input type="radio" id="roundtrip" name="trip" value="‡πÑ‡∏õ-‡∏Å‡∏•‡∏±‡∏ö" checked><label for="roundtrip">‡πÑ‡∏õ-‡∏Å‡∏•‡∏±‡∏ö</label></div>
                <div class="radio-group"><input type="radio" id="oneway" name="trip" value="‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß"><label for="oneway">‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</label></div>
            </div>
            <div class="section">
                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                    <input type="checkbox" id="directFlight" style="width: 20px; height: 20px; cursor: pointer; accent-color: #2e7d32;">
                    <span style="font-size: 16px;">‚úàÔ∏è ‡∏ö‡∏¥‡∏ô‡∏ï‡∏£‡∏á (‡πÑ‡∏°‡πà‡πÅ‡∏ß‡∏∞‡∏à‡∏≠‡∏î)</span>
                </label>
            </div>
            <div class="section">
                <div class="section-title">‚úàÔ∏è ‡∏™‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏¥‡∏ô</div>
                <div class="input-group">
                    <label>‡∏™‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏¥‡∏ô (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
                    <input type="text" id="airline" placeholder="‡πÄ‡∏ä‡πà‡∏ô Thai Airways, AirAsia">
                    <small>‡∏£‡∏∞‡∏ö‡∏∏‡∏™‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏ß‡πâ</small>
                </div>
            </div>
            <div class="section">
                <div class="section-title">‚úàÔ∏è ‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á</div>
                <div class="location-inputs">
                    <div class="input-group" id="fromGroup">
                        <label>‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á</label>
                        <input type="text" id="from" placeholder="‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø, ‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà, ‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï">
                        <small class="error">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á</small>
                    </div>
                    <button class="swap-btn" type="button" id="swapBtn">
                        <svg viewBox="0 0 24 24"><path d="M16 17.01V10h-2v7.01h-3L15 21l4-3.99h-3zM9 3L5 6.99h3V14h2V6.99h3L9 3z"/></svg>
                    </button>
                    <div class="input-group" id="toGroup">
                        <label>‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á</label>
                        <input type="text" id="to" placeholder="‡∏™‡∏¥‡∏á‡∏Ñ‡πÇ‡∏õ‡∏£‡πå, ‡∏Æ‡πà‡∏≠‡∏á‡∏Å‡∏á, ‡πÇ‡∏ï‡πÄ‡∏Å‡∏µ‡∏¢‡∏ß">
                        <small class="error">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á</small>
                    </div>
                </div>
            </div>
            <div class="section">
                <div class="section-title">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á</div>
                <div class="date-inputs">
                    <div class="input-group" id="departGroup">
                        <label>‡∏Ç‡∏≤‡πÑ‡∏õ</label>
                        <input type="text" id="departDate" placeholder="‡∏ß‡∏ß/‡∏î‡∏î/‡∏õ‡∏õ‡∏õ‡∏õ" maxlength="10">
                        <small>‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: ‡∏ß‡∏±‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ (‡πÄ‡∏ä‡πà‡∏ô 10/11/2568)</small>
                        <small class="error">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</small>
                    </div>
                    <div class="input-group" id="returnGroup">
                        <label>‡∏Ç‡∏≤‡∏Å‡∏•‡∏±‡∏ö</label>
                        <input type="text" id="returnDate" placeholder="‡∏ß‡∏ß/‡∏î‡∏î/‡∏õ‡∏õ‡∏õ‡∏õ" maxlength="10">
                        <small>‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: ‡∏ß‡∏±‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ (‡πÄ‡∏ä‡πà‡∏ô 15/11/2568)</small>
                        <small class="error">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</small>
                    </div>
                </div>
            </div>
            <div class="section">
                <div class="section-title">üë• ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£</div>
                <div class="passenger-row">
                    <div class="passenger-info"><h3>‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà</h3><p>‡∏≠‡∏≤‡∏¢‡∏∏ 12 ‡∏õ‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ</p></div>
                    <div class="counter">
                        <button class="counter-btn" type="button" data-type="adult" data-delta="-1">‚àí</button>
                        <span class="counter-value" id="adult-count">1</span>
                        <button class="counter-btn" type="button" data-type="adult" data-delta="1">+</button>
                    </div>
                </div>
                <div class="passenger-row">
                    <div class="passenger-info"><h3>‡πÄ‡∏î‡πá‡∏Å</h3><p>‡∏≠‡∏≤‡∏¢‡∏∏ 2-11 ‡∏õ‡∏µ</p></div>
                    <div class="counter">
                        <button class="counter-btn" type="button" data-type="child" data-delta="-1">‚àí</button>
                        <span class="counter-value" id="child-count">0</span>
                        <button class="counter-btn" type="button" data-type="child" data-delta="1">+</button>
                    </div>
                </div>
                <div class="passenger-row">
                    <div class="passenger-info"><h3>‡∏ó‡∏≤‡∏£‡∏Å‡∏ô‡∏±‡πà‡∏á‡∏ï‡∏±‡∏Å</h3><p>‡∏≠‡∏≤‡∏¢‡∏∏‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 2 ‡∏õ‡∏µ</p></div>
                    <div class="counter">
                        <button class="counter-btn" type="button" data-type="infant" data-delta="-1">‚àí</button>
                        <span class="counter-value" id="infant-count">0</span>
                        <button class="counter-btn" type="button" data-type="infant" data-delta="1">+</button>
                    </div>
                </div>
            </div>
            <div class="section">
                <div class="section-title">üí∫ ‡∏ä‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</div>
                <div class="input-group">
                    <select id="class">
                        <option value="‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î">‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î</option>
                        <option value="‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡∏¢‡∏°">‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡∏¢‡∏°</option>
                        <option value="‡∏ä‡∏±‡πâ‡∏ô‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à">‡∏ä‡∏±‡πâ‡∏ô‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</option>
                        <option value="‡∏ä‡∏±‡πâ‡∏ô‡∏´‡∏£‡∏π">‡∏ä‡∏±‡πâ‡∏ô‡∏´‡∏£‡∏π</option>
                    </select>
                </div>
            </div>
            <div class="section">
                <div class="section-title">üìû ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</div>
                <div class="input-group" id="phoneGroup">
                    <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
                    <input type="tel" id="phone" placeholder="08X-XXX-XXXX">
                    <small>‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß</small>
                    <small class="error">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</small>
                </div>
            </div>
            <button class="submit-btn" type="button" id="submitBtn">‡πÄ‡∏ä‡πá‡∏Ñ‡∏£‡∏≤‡∏Ñ‡∏≤</button>
            <p class="footer-note">üí¨ ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡πá‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ñ‡∏£‡∏±‡∏ö/‡∏Ñ‡πà‡∏∞</p>
        </div>
    </div>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <p style="font-size: 16px; color: #333;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
            <p style="font-size: 13px; color: #999; margin-top: 10px;">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà</p>
        </div>
    </div>
    <script>
        const CONFIG={GOOGLE_SCRIPT_URL:'https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec',LIFF_ID:'2008429094-y2WmXkYQ'};
        let counts={adult:1,child:0,infant:0},userProfile=null;
        function showMessage(t,m){const e=document.getElementById(t==='success'?'successMessage':'errorMessage');e.textContent=m;e.style.display='block';setTimeout(()=>e.style.display='none',5000);}
        function showLoading(s){document.getElementById('loadingOverlay').classList.toggle('active',s);document.getElementById('submitBtn').disabled=s;}
        function showError(g,m){const el=document.getElementById(g);if(el){el.classList.add('has-error');const e=el.querySelector('.error');if(e&&m)e.textContent=m;}}
        function clearError(g){const el=document.getElementById(g);if(el)el.classList.remove('has-error');}
        function getTodayThaiDate(){const d=new Date();return`${String(d.getDate()).padStart(2,'0')}/${String(d.getMonth()+1).padStart(2,'0')}/${d.getFullYear()+543}`;}
        function formatDateInput(i){let v=i.value.replace(/\D/g,'');if(v.length>=2)v=v.slice(0,2)+'/'+v.slice(2);if(v.length>=5)v=v.slice(0,5)+'/'+v.slice(5,9);i.value=v;}
        function isValidDate(d,m,y){if(d<1||d>31||m<1||m>12||y<2500)return false;const days=[31,28,31,30,31,30,31,31,30,31,30,31],gy=y-543;if((gy%4===0&&gy%100!==0)||gy%400===0)days[1]=29;return d<=days[m-1];}
        function validateThaiDate(s){if(!s)return false;const p=s.split('/');if(p.length!==3)return false;const d=parseInt(p[0]),m=parseInt(p[1]),y=parseInt(p[2]);if(!isValidDate(d,m,y))return false;const inputDate=new Date(y-543,m-1,d),today=new Date();today.setHours(0,0,0,0);return inputDate>=today;}
        function thaiDateToISO(s){if(!s)return'';const p=s.split('/');return`${parseInt(p[2])-543}-${p[1].padStart(2,'0')}-${p[0].padStart(2,'0')}`;}
        function compareDates(d1,d2){const iso1=thaiDateToISO(d1),iso2=thaiDateToISO(d2);return iso1<iso2?-1:iso1>iso2?1:0;}
        function validatePhone(p){if(!p)return true;return/^0[0-9]{8,9}$/.test(p.replace(/[-\s]/g,''));}
        ['departDate','returnDate'].forEach(id=>{const input=document.getElementById(id);input.addEventListener('input',()=>{formatDateInput(input);clearError(id+'Group');});input.addEventListener('blur',()=>{if(input.value&&!validateThaiDate(input.value))showError(id+'Group','‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');});});
        document.getElementById('departDate').value=getTodayThaiDate();
        document.querySelectorAll('input[name="trip"]').forEach(r=>{r.addEventListener('change',function(){const ret=document.getElementById('returnDate'),retG=document.getElementById('returnGroup');if(this.value==='‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß'){ret.disabled=true;ret.value='';retG.style.opacity='0.5';}else{ret.disabled=false;retG.style.opacity='1';}});});
        window.onload=()=>{if(typeof liff!=='undefined'){liff.init({liffId:CONFIG.LIFF_ID}).then(()=>{if(liff.isInClient()){liff.getProfile().then(p=>{userProfile=p;document.getElementById('userInfo').style.display='flex';document.getElementById('userName').textContent=p.displayName;document.getElementById('userPicture').src=p.pictureUrl;}).catch(console.error);}}).catch(console.error);}};
        document.getElementById('swapBtn').addEventListener('click',()=>{const from=document.getElementById('from'),to=document.getElementById('to');[from.value,to.value]=[to.value,from.value];clearError('fromGroup');clearError('toGroup');});
        document.querySelectorAll('.counter-btn').forEach(btn=>{btn.addEventListener('click',function(){const type=this.getAttribute('data-type'),delta=parseInt(this.getAttribute('data-delta')),newVal=counts[type]+delta;if(type==='adult'&&newVal<1)return;if(newVal<0||newVal>9)return;if(type==='infant'&&newVal>counts.adult){showMessage('error','‚ö†Ô∏è ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏≤‡∏£‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà');return;}if(type==='adult'&&newVal<counts.infant){showMessage('error','‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏î‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà‡πÑ‡∏î‡πâ ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏°‡∏µ‡∏ó‡∏≤‡∏£‡∏Å‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤');return;}const temp={...counts,[type]:newVal},total=temp.adult+temp.child+temp.infant;if(total>9){showMessage('error','‚ö†Ô∏è ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£‡∏£‡∏ß‡∏°‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 9 ‡∏Ñ‡∏ô');return;}counts[type]=newVal;document.getElementById(`${type}-count`).textContent=newVal;});});
        document.getElementById('submitBtn').addEventListener('click',async()=>{['fromGroup','toGroup','departGroup','returnGroup','phoneGroup'].forEach(clearError);const tripType=document.querySelector('input[name="trip"]:checked').value,from=document.getElementById('from').value.trim(),to=document.getElementById('to').value.trim(),departDate=document.getElementById('departDate').value.trim(),returnDate=document.getElementById('returnDate').value.trim(),phone=document.getElementById('phone').value.trim(),airline=document.getElementById('airline').value.trim(),directFlight=document.getElementById('directFlight').checked,seatClass=document.getElementById('class').value;let hasError=false;if(!from){showError('fromGroup','‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á');hasError=true;}if(!to){showError('toGroup','‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á');hasError=true;}if(!departDate||!validateThaiDate(departDate)){showError('departGroup','‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡πÑ‡∏õ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');hasError=true;}if(tripType==='‡πÑ‡∏õ-‡∏Å‡∏•‡∏±‡∏ö'){if(!returnDate||!validateThaiDate(returnDate)){showError('returnGroup','‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');hasError=true;}else if(compareDates(departDate,returnDate)>=0){showError('returnGroup','‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏•‡∏±‡∏ö‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏õ');hasError=true;}}if(phone&&!validatePhone(phone)){showError('phoneGroup','‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');hasError=true;}if(hasError){showMessage('error','‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');return;}const reqNum=`REQ${Date.now().toString().slice(-6)}${Math.random().toString(36).substring(2,5).toUpperCase()}`,data={requestNumber:reqNum,tripType,from,to,departDate,returnDate:tripType==='‡πÑ‡∏õ-‡∏Å‡∏•‡∏±‡∏ö'?returnDate:'-',adults:counts.adult,children:counts.child,infants:counts.infant,seatClass,airline:airline||'-',directFlight:directFlight?'‡πÉ‡∏ä‡πà':'‡πÑ‡∏°‡πà',phone:phone||'-',userName:userProfile?.displayName||'‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏',userId:userProfile?.userId||'unknown',timestamp:new Date().toLocaleString('th-TH')};showLoading(true);try{await fetch(CONFIG.GOOGLE_SCRIPT_URL,{method:'POST',mode:'no-cors',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});showMessage('success',`‚úÖ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç: ${reqNum}`);if(typeof liff!=='undefined'&&liff.isInClient()){const msg=`üìã ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏à‡∏≠‡∏á‡∏ï‡∏±‡πã‡∏ß #${reqNum}\n\nüõ´ ${tripType}\nüìç ${from} ‚Üí ${to}\nüìÖ ‡πÑ‡∏õ: ${departDate}${tripType==='‡πÑ‡∏õ-‡∏Å‡∏•‡∏±‡∏ö'?`\nüìÖ ‡∏Å‡∏•‡∏±‡∏ö: ${returnDate}`:''}\nüë• ${counts.adult} ‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà, ${counts.child} ‡πÄ‡∏î‡πá‡∏Å, ${counts.infant} ‡∏ó‡∏≤‡∏£‡∏Å\nüí∫ ${seatClass}\n${airline?`‚úàÔ∏è ${airline}\n`:''}${directFlight?'‚úÖ ‡∏ö‡∏¥‡∏ô‡∏ï‡∏£‡∏á\n':''}${phone?`üìû ${phone}\n`:''}\n‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏£‡πá‡∏ß‡πÜ‡∏ô‡∏µ‡πâ‡∏Ñ‡πà‡∏∞`;liff.sendMessages([{type:'text',text:msg}]).then(()=>liff.closeWindow()).catch(console.error);}}catch(err){console.error(err);showMessage('error','‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà');}finally{showLoading(false);}});
    </script>
</body>
</html>
